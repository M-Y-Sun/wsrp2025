(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     71173,       1620]
NotebookOptionsPosition[     65963,       1534]
NotebookOutlinePosition[     66356,       1550]
CellTagsIndexPosition[     66313,       1547]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "2"}], ";"}]}], "Input",
 CellChangeTimes->{{3.960644286027936*^9, 3.960644291710787*^9}, {
  3.960648341262424*^9, 3.960648341360713*^9}, {3.9606484191982927`*^9, 
  3.960648419244483*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"a12242b9-b1c9-44e3-92ef-7fdbb93922f3"],

Cell[CellGroupData[{

Cell["prune", "Subsection",
 CellChangeTimes->{{3.9606713130561867`*^9, 
  3.960671313380475*^9}},ExpressionUUID->"3593b4a1-2d33-4767-80e2-\
aec691c27d16"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getinfo", "[", "r_", "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Flatten", "@", 
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"r", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graph", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"VertexLabels", "->", "Automatic"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{
  3.960645893516172*^9, {3.960646168400104*^9, 3.960646197807621*^9}, {
   3.960646605817322*^9, 3.960646606880862*^9}, 3.9606791190713673`*^9, {
   3.960679151088855*^9, 3.9606791544453487`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"f75f5dce-d067-4e39-8fe4-0f4e60b4b147"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transform", "[", 
   RowBox[{"reachable_List", ",", "info_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "@@", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"reachable", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"info", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"8", "*", "j"}], "-", "7"}], ";;", 
              RowBox[{"8", "*", "j"}]}]}], "]"}], "]"}], "\[IndentingNewLine]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "8"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
    RowBox[{"(*", " ", 
     RowBox[{"end", " ", "Table", " ", "over", " ", "j"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "info", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"end", " ", "Table", " ", "over", " ", "i"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.960712108823913*^9, 3.960712175877442*^9}, {
   3.960712372423163*^9, 3.9607123728510933`*^9}, {3.960712451883089*^9, 
   3.960712452539041*^9}, 
   3.9607129618754673`*^9},ExpressionUUID->"1c601070-3979-4bb6-9da3-\
0f6328fe6a0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ctransform", "=", 
   RowBox[{"Compile", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"reachable", ",", "_Integer", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"info", ",", "_Integer", ",", "2"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"transform", "[", 
      RowBox[{"reachable", ",", "info"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"RuntimeAttributes", "->", 
      RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9607121826855593`*^9, 3.960712336493713*^9}, {
   3.960712383528637*^9, 3.9607123894619627`*^9}, {3.960712626304348*^9, 
   3.9607126263837843`*^9}, 3.960712678395905*^9, {3.960712989924905*^9, 
   3.960712998123481*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"83d509c4-d56a-49d7-99b5-7ce10f9123fd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"prune", "[", 
   RowBox[{"map_DataStructure", ",", "rules_List"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"info", "=", 
       RowBox[{"getinfo", "/@", "rules"}]}], ",", "reachables", ",", "transL",
       ",", "reachable"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reachables", "=", 
      RowBox[{"AbsoluteTiming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PadLeft", "[", 
          RowBox[{
           RowBox[{"VertexOutComponent", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], ",", "3", ",", 
           RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
        RowBox[{"info", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"transL", "=", 
      RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
       RowBox[{"ctransform", "[", 
        RowBox[{
         RowBox[{"reachables", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"info", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"reachable", "=", 
            RowBox[{"reachables", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Join", "@@", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"reachable", ",", "j"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"info", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"8", "*", "j"}], "-", "7"}], ";;", 
                    RowBox[{"8", "*", "j"}]}]}], "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"0", ",", "8"}], "]"}]}], "\[IndentingNewLine]", 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", "n"}], "}"}]}], "\[IndentingNewLine]", 
             "]"}]}]}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"end", " ", "Table", " ", "over", " ", "j"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "info", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], 
        RowBox[{"(*", " ", 
         RowBox[{"end", " ", "Table", " ", "over", " ", "i"}], " ", "*)"}], 
        "*)"}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"map", "[", 
        RowBox[{"\"\<Insert\>\"", ",", 
         RowBox[{"(", 
          RowBox[{"#", "->", 
           RowBox[{
            RowBox[{"map", "[", 
             RowBox[{"\"\<Lookup\>\"", ",", "#", ",", 
              RowBox[{"0", "&"}]}], "]"}], "+", "1"}]}], ")"}]}], "]"}], 
       "&"}], "/@", 
      RowBox[{"transL", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", 
     RowBox[{"(*", "sequential", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"reachables", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"transL", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"map", "=", 
   RowBox[{"CreateDataStructure", "[", "\"\<HashTable\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rules", "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "2"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "@", 
  RowBox[{"prune", "[", 
   RowBox[{"map", ",", "%"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.960644444625381*^9, {3.960645206650008*^9, 3.960645263136382*^9}, {
   3.9606453492352943`*^9, 3.960645349398921*^9}, {3.960645382581768*^9, 
   3.960645382786523*^9}, {3.9606467826089993`*^9, 3.960646784053727*^9}, {
   3.9606468696547413`*^9, 3.960646870116309*^9}, {3.9606469526377563`*^9, 
   3.960646964831485*^9}, {3.960647030924445*^9, 3.960647204609453*^9}, {
   3.960647283473796*^9, 3.960647291831983*^9}, {3.960647349314056*^9, 
   3.9606473684601316`*^9}, {3.9606474167018957`*^9, 
   3.9606474720526114`*^9}, {3.960647518677609*^9, 3.960647528327667*^9}, {
   3.9606475621765127`*^9, 3.960647563085348*^9}, {3.9606475982571287`*^9, 
   3.960647683321907*^9}, {3.960647731244691*^9, 3.9606477450162897`*^9}, {
   3.960647788508236*^9, 3.960647842570931*^9}, {3.960647998458479*^9, 
   3.960648059602953*^9}, {3.960648118160726*^9, 3.960648148255415*^9}, {
   3.960648210654891*^9, 3.960648244277281*^9}, {3.960649039379752*^9, 
   3.960649066249064*^9}, {3.960675337980174*^9, 3.960675339982596*^9}, {
   3.960675402155993*^9, 3.960675560132691*^9}, {3.960675623079352*^9, 
   3.960675761786447*^9}, {3.9606759166675663`*^9, 3.960675916990776*^9}, {
   3.960675951907674*^9, 3.96067600751709*^9}, {3.960676125252016*^9, 
   3.960676269662652*^9}, {3.960676452410956*^9, 3.960676454523058*^9}, {
   3.960676522661462*^9, 3.960676559899909*^9}, {3.960676593603303*^9, 
   3.960676606248275*^9}, {3.960676644191695*^9, 3.96067666293715*^9}, {
   3.9606771639392147`*^9, 3.960677229313366*^9}, {3.960677265630692*^9, 
   3.960677349075975*^9}, {3.960677542514333*^9, 3.9606775723682404`*^9}, {
   3.9606776175789843`*^9, 3.9606776433184347`*^9}, {3.960677811032053*^9, 
   3.9606778429059772`*^9}, {3.960677884251009*^9, 3.96067788634505*^9}, {
   3.960677924153235*^9, 3.960677934994321*^9}, {3.960678043989975*^9, 
   3.9606780767124243`*^9}, {3.9606782808519773`*^9, 
   3.9606782810842752`*^9}, {3.960687289033272*^9, 3.9606872897075243`*^9}, 
   3.960711925850589*^9, 3.9607120170814257`*^9, {3.9607120619642477`*^9, 
   3.9607120658605433`*^9}, {3.9607123524362507`*^9, 3.96071235949757*^9}, {
   3.9607123983134117`*^9, 3.960712437446419*^9}, {3.9607124776743727`*^9, 
   3.9607124866614523`*^9}, {3.960712546646999*^9, 3.9607125520207453`*^9}, {
   3.960712589291312*^9, 3.96071259145333*^9}, {3.960712639529833*^9, 
   3.960712684124927*^9}, {3.9607127204016*^9, 3.9607127314193707`*^9}, {
   3.960712985402998*^9, 3.960712986908596*^9}, {3.960713232592239*^9, 
   3.960713249526555*^9}, {3.9607133730271273`*^9, 3.960713432709482*^9}, {
   3.960713652620379*^9, 3.960713653095693*^9}, {3.960713958567771*^9, 
   3.960713965974888*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"e396a1c9-4716-4c65-a829-35c158031a47"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "0"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "0"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "0"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "0"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1"}], "}"}]}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.9607124818245707`*^9, 3.9607124869263983`*^9}, {
   3.960712554469788*^9, 3.9607125568268433`*^9}, {3.9607125917297497`*^9, 
   3.960712595023304*^9}, {3.960712647820321*^9, 3.9607126843024473`*^9}, {
   3.960712987209024*^9, 3.960713002736762*^9}, 3.960713251485272*^9, {
   3.9607133859991913`*^9, 3.9607134334971457`*^9}, {3.9607139828381166`*^9, 
   3.96071399249936*^9}},
 CellLabel->
  "Out[146]=",ExpressionUUID->"e778a170-0895-41cb-94eb-53fe65fddc9d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000232`", ",", 
   RowBox[{"{", 
    RowBox[{"0.000032`", ",", "0.000051`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9607124818245707`*^9, 3.9607124869263983`*^9}, {
   3.960712554469788*^9, 3.9607125568268433`*^9}, {3.9607125917297497`*^9, 
   3.960712595023304*^9}, {3.960712647820321*^9, 3.9607126843024473`*^9}, {
   3.960712987209024*^9, 3.960713002736762*^9}, 3.960713251485272*^9, {
   3.9607133859991913`*^9, 3.9607134334971457`*^9}, {3.9607139828381166`*^9, 
   3.960713992535892*^9}},
 CellLabel->
  "Out[147]=",ExpressionUUID->"89f18968-5431-4b07-a5fd-77ca50a3e1d6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"parallelprune", "[", 
   RowBox[{"map_DataStructure", ",", "rules_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"info", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"getinfo", ",", "rules"}], "]"}]}], ",", "reachables", ",", 
      "transL"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reachables", "=", 
      RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
       RowBox[{"ParallelMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"VertexOutComponent", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "&"}], ",", 
         RowBox[{"info", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"transL", "=", 
      RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"info", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"8", "*", 
                   RowBox[{"(", 
                    RowBox[{"#", "-", "1"}], ")"}]}], "+", "1"}], ",", 
                 RowBox[{"8", "*", "#"}]}], "}"}]}], "]"}], "&"}], "/@", 
            RowBox[{"reachables", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "info", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"map", "[", 
        RowBox[{"\"\<Insert\>\"", ",", 
         RowBox[{"(", 
          RowBox[{"#", "->", 
           RowBox[{
            RowBox[{"map", "[", 
             RowBox[{"\"\<Lookup\>\"", ",", "#", ",", 
              RowBox[{"0", "&"}]}], "]"}], "+", "1"}]}], ")"}]}], "]"}], 
       "&"}], "/@", 
      RowBox[{"transL", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", 
     RowBox[{"(*", "sequential", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"reachables", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"transL", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.960648222541037*^9, 3.960648232836104*^9}, {
   3.960675384760379*^9, 3.9606754096702642`*^9}, 
   3.960713681748377*^9},ExpressionUUID->"a7c356a0-3a27-4303-ae7c-\
e5c247dff36a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lookup", "[", 
   RowBox[{"map_DataStructure", ",", "rules_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"info", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"getinfo", ",", "rules"}], "]"}]}], ",", "reachables", ",", 
      "transL"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reachables", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"VertexOutComponent", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"info", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
     RowBox[{"transL", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{
              RowBox[{"info", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"8", "*", 
                  RowBox[{"(", 
                   RowBox[{"#", "-", "1"}], ")"}]}], "+", "1"}], ",", 
                RowBox[{"8", "*", "#"}]}], "}"}]}], "]"}], "&"}], "/@", 
           RowBox[{"reachables", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "info", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"map", "[", 
        RowBox[{"\"\<Lookup\>\"", ",", "#"}], "]"}], "&"}], "/@", 
      "transL"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.96064672270205*^9, 3.96064672422958*^9}, 
   3.960712749688157*^9},ExpressionUUID->"25c6cc06-24ea-4c0f-8692-\
d285be96ec72"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmRuleFromNum", "=", 
   RowBox[{
   "ResourceFunction", "[", "\"\<TuringMachineFromNumber\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmRuleToNum", "=", 
   RowBox[{"ResourceFunction", "[", "\"\<TuringMachineToNumber\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.960645582050539*^9, 3.9606456047973757`*^9}, {
  3.960645650554042*^9, 3.9606456513541117`*^9}, {3.9606487002169437`*^9, 
  3.960648706194716*^9}, {3.960649100332584*^9, 3.96064910103572*^9}, {
  3.960649226703933*^9, 3.960649244414358*^9}, {3.9606492895513678`*^9, 
  3.9606493180257683`*^9}, {3.960649567633615*^9, 3.960649568492584*^9}, {
  3.960715277292451*^9, 3.9607152872700233`*^9}, {3.960715317393302*^9, 
  3.960715329472686*^9}, {3.9607156274431*^9, 3.960715627565304*^9}, {
  3.960715665579442*^9, 
  3.960715758328306*^9}},ExpressionUUID->"d9fcde08-c5f0-45ff-98e4-\
14451b64a07d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"2", "*", "n", "*", "k"}], ")"}], "^", 
  RowBox[{"(", 
   RowBox[{"n", "*", "k"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"ParallelMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"tmRuleFromNum", "[", 
       RowBox[{"#", ",", "n", ",", "k"}], "]"}], "&"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", 
       RowBox[{"%", "-", "1"}]}], "]"}]}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"%", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%%", "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "rules", "]"}]}], "Input",
 CellChangeTimes->{{3.9606445734738626`*^9, 3.960644611475769*^9}, {
   3.9606446767338943`*^9, 3.960644728288681*^9}, {3.960644770414815*^9, 
   3.960644772442008*^9}, 3.960645103895913*^9, {3.960646241543298*^9, 
   3.960646245094597*^9}, 3.960646295726183*^9, {3.960646564526754*^9, 
   3.96064657302522*^9}, {3.960646619001568*^9, 3.960646619535315*^9}, 
   3.960647510437544*^9, {3.960647854826033*^9, 3.960647854957642*^9}, {
   3.960647934092589*^9, 3.96064793552666*^9}, {3.960648363696925*^9, 
   3.9606483640544653`*^9}, {3.9606484264180613`*^9, 3.960648427367722*^9}, {
   3.960648710990664*^9, 3.960648716623597*^9}, {3.960648825606976*^9, 
   3.960648839421981*^9}, {3.960649614637595*^9, 3.960649618016692*^9}, {
   3.960650092638603*^9, 3.960650110061626*^9}, {3.960683996021421*^9, 
   3.9606839969323797`*^9}, {3.9607154194900713`*^9, 3.960715429272438*^9}, {
   3.960715561498109*^9, 3.960715577517952*^9}, {3.960715761802456*^9, 
   3.9607157655428963`*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"c06abed9-9d89-4054-b872-089491604238"],

Cell[BoxData["2985984"], "Output",
 CellChangeTimes->{
  3.960646315577489*^9, 3.960646396672982*^9, 3.960646438998518*^9, 
   3.960646589246648*^9, 3.960646631825782*^9, 3.960646746195168*^9, 
   3.960646815325891*^9, {3.9606475107008*^9, 3.9606475117117157`*^9}, 
   3.960647827566505*^9, 3.960647867596407*^9, 3.960647999741892*^9, {
   3.960648359489647*^9, 3.960648364553404*^9}, 3.9606485580517597`*^9, 
   3.960648733186224*^9, {3.9606488245732822`*^9, 3.960648837714682*^9}, 
   3.960648969518382*^9, 3.960649619911344*^9, 3.960649758916379*^9, {
   3.960650100434371*^9, 3.960650110207467*^9}, 3.960671256220837*^9, 
   3.960673146617196*^9, 3.96067510931367*^9, {3.9606802692994413`*^9, 
   3.96068028884094*^9}, 3.960682585377652*^9, 3.960683786606591*^9, 
   3.960683938397006*^9, 3.960683997378965*^9, 3.960687011106812*^9, 
   3.960711539543064*^9, {3.9607153420818977`*^9, 3.9607153500200033`*^9}, {
   3.9607154205076637`*^9, 3.960715429630971*^9}, {3.960715528772566*^9, 
   3.9607156405484858`*^9}, {3.960715740199387*^9, 3.960715766469083*^9}},
 CellLabel->
  "Out[271]=",ExpressionUUID->"937721a6-4358-438b-b576-42a2cd4027c4"],

Cell[BoxData["194.201538`"], "Output",
 CellChangeTimes->{
  3.960646315577489*^9, 3.960646396672982*^9, 3.960646438998518*^9, 
   3.960646589246648*^9, 3.960646631825782*^9, 3.960646746195168*^9, 
   3.960646815325891*^9, {3.9606475107008*^9, 3.9606475117117157`*^9}, 
   3.960647827566505*^9, 3.960647867596407*^9, 3.960647999741892*^9, {
   3.960648359489647*^9, 3.960648364553404*^9}, 3.9606485580517597`*^9, 
   3.960648733186224*^9, {3.9606488245732822`*^9, 3.960648837714682*^9}, 
   3.960648969518382*^9, 3.960649619911344*^9, 3.960649758916379*^9, {
   3.960650100434371*^9, 3.960650110207467*^9}, 3.960671256220837*^9, 
   3.960673146617196*^9, 3.96067510931367*^9, {3.9606802692994413`*^9, 
   3.96068028884094*^9}, 3.960682585377652*^9, 3.960683786606591*^9, 
   3.960683938397006*^9, 3.960683997378965*^9, 3.960687011106812*^9, 
   3.960711539543064*^9, {3.9607153420818977`*^9, 3.9607153500200033`*^9}, {
   3.9607154205076637`*^9, 3.960715429630971*^9}, {3.960715528772566*^9, 
   3.9607156405484858`*^9}, 3.960715740199387*^9, 3.960715960634315*^9},
 CellLabel->
  "Out[274]=",ExpressionUUID->"222afdea-f54d-43a2-bc73-c8688fe32842"],

Cell[BoxData["2985984"], "Output",
 CellChangeTimes->{
  3.960646315577489*^9, 3.960646396672982*^9, 3.960646438998518*^9, 
   3.960646589246648*^9, 3.960646631825782*^9, 3.960646746195168*^9, 
   3.960646815325891*^9, {3.9606475107008*^9, 3.9606475117117157`*^9}, 
   3.960647827566505*^9, 3.960647867596407*^9, 3.960647999741892*^9, {
   3.960648359489647*^9, 3.960648364553404*^9}, 3.9606485580517597`*^9, 
   3.960648733186224*^9, {3.9606488245732822`*^9, 3.960648837714682*^9}, 
   3.960648969518382*^9, 3.960649619911344*^9, 3.960649758916379*^9, {
   3.960650100434371*^9, 3.960650110207467*^9}, 3.960671256220837*^9, 
   3.960673146617196*^9, 3.96067510931367*^9, {3.9606802692994413`*^9, 
   3.96068028884094*^9}, 3.960682585377652*^9, 3.960683786606591*^9, 
   3.960683938397006*^9, 3.960683997378965*^9, 3.960687011106812*^9, 
   3.960711539543064*^9, {3.9607153420818977`*^9, 3.9607153500200033`*^9}, {
   3.9607154205076637`*^9, 3.960715429630971*^9}, {3.960715528772566*^9, 
   3.9607156405484858`*^9}, 3.960715740199387*^9, 3.9607159606723633`*^9},
 CellLabel->
  "Out[275]=",ExpressionUUID->"cb53e691-580b-4199-b7c0-c372b6e6bb25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"map", "=", 
   RowBox[{"CreateDataStructure", "[", "\"\<HashTable\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "@", 
  RowBox[{"prune", "[", 
   RowBox[{"map", ",", "rules"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.960644298951412*^9, 3.9606443126012487`*^9}, {
   3.960645172734548*^9, 3.96064517361386*^9}, {3.9606453164697227`*^9, 
   3.960645317793901*^9}, {3.960645411351679*^9, 3.960645413421945*^9}, {
   3.960648985639591*^9, 3.96064899154432*^9}, 3.960649054772176*^9, {
   3.960649104340526*^9, 3.96064911422554*^9}, {3.9606492499958572`*^9, 
   3.9606492542413683`*^9}, {3.960649381349947*^9, 3.9606493853235188`*^9}, {
   3.960650055944984*^9, 3.9606500783017883`*^9}, {3.960675373571609*^9, 
   3.960675374828927*^9}, {3.960676278454206*^9, 3.960676283620884*^9}, {
   3.960682950803318*^9, 3.960682950936152*^9}, {3.960683012369774*^9, 
   3.96068301351661*^9}, {3.9606840018014917`*^9, 3.960684002611541*^9}, {
   3.960713155748797*^9, 3.9607131889782333`*^9}, {3.960713266408886*^9, 
   3.960713271573491*^9}, {3.960713442181899*^9, 3.9607134644553413`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"1aa6a9f2-5210-4a0a-8269-da7b0cb5d19c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"112.925075`", ",", 
   RowBox[{"{", 
    RowBox[{"7.851965`", ",", "17.583271`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.960678435046577*^9, 3.960680596965315*^9, 3.960682910067184*^9, 
   3.96068431217982*^9, 3.960687325007435*^9, 3.960711861652247*^9, 
   3.960712934607028*^9, {3.960713131465283*^9, 3.9607131911538887`*^9}, {
   3.960713257412533*^9, 3.960713271998425*^9}, {3.960713439356309*^9, 
   3.9607134451939497`*^9}, 3.960713858498725*^9, 3.960714116157349*^9},
 CellLabel->
  "Out[149]=",ExpressionUUID->"d02ceb01-968e-42c8-b621-a905d12a56b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"elems", "=", 
   RowBox[{"map", "[", "\"\<Elements\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.9606790331604967`*^9, 3.960679045986754*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"391e68e6-5cf6-4257-9e00-818c5c206254"],

Cell[BoxData["1775632"], "Output",
 CellChangeTimes->{{3.960679044508416*^9, 3.9606790479456787`*^9}, 
   3.960680598160331*^9, 3.9606829112709084`*^9, 3.96068431349479*^9, {
   3.960687326195215*^9, 3.960687327364333*^9}, 3.960688456240958*^9, 
   3.960711862881989*^9, 3.960712940498374*^9, 3.960713139940625*^9, 
   3.960713859710799*^9},
 CellLabel->
  "Out[139]=",ExpressionUUID->"d60aef83-fe50-47d2-9283-1d59a4ab2ccb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["simulate", "Subsection",
 CellChangeTimes->{{3.9606713261799107`*^9, 
  3.9606713424592667`*^9}},ExpressionUUID->"694e79da-f825-4c0f-b70d-\
16bc848cd5d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxiters", "=", "64"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bits", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"width", "=", "4"}], ";"}]}], "Input",
 CellChangeTimes->{{3.960672070742519*^9, 3.960672076013701*^9}, {
   3.9606721255630693`*^9, 3.960672131103155*^9}, {3.960672903591114*^9, 
   3.960672904313733*^9}, 3.96067434550095*^9},
 CellLabel->
  "In[150]:=",ExpressionUUID->"2acc88a5-295f-410a-8b8e-9ad37916cbca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"init", "[", "n_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "width"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"n", ",", "2", ",", "width"}], "]"}], ",", "0"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.9602986163629923`*^9, 3.9602986167878933`*^9}, {
   3.9602986686212273`*^9, 3.960298689071632*^9}, {3.960298823945261*^9, 
   3.960298824412078*^9}, {3.96030020274676*^9, 3.960300203554926*^9}, {
   3.9603002530698357`*^9, 3.960300266185831*^9}, {3.960302268585175*^9, 
   3.960302268850256*^9}, {3.960302305920265*^9, 3.96030232321241*^9}, {
   3.9603032720964127`*^9, 3.960303298790053*^9}, {3.960304311832287*^9, 
   3.960304329972269*^9}, {3.960325516016612*^9, 3.960325521767125*^9}, {
   3.960325749361034*^9, 3.960325779806476*^9}, 3.960336814648542*^9, {
   3.960374984990382*^9, 3.9603749898961687`*^9}, {3.960384432872294*^9, 
   3.960384432963406*^9}, {3.960384554532146*^9, 3.9603845554835997`*^9}, {
   3.960453280259739*^9, 3.960453286845212*^9}, {3.960456654848476*^9, 
   3.960456655607476*^9}, {3.960678725159189*^9, 3.960678725639851*^9}, {
   3.960683791313017*^9, 3.960683796084404*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"882c7138-8d67-4ad7-95eb-86a9bf877760"],

Cell["TODO: increase maxiters and simulate in blocks", "CodeText",
 CellChangeTimes->{{3.9607158889931*^9, 
  3.9607158993374767`*^9}},ExpressionUUID->"19fd9b08-f4d2-4839-b9ec-\
a1711abc1196"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hist", "[", 
   RowBox[{"rule_Integer", ",", " ", "num_Integer"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"min", "=", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "-", 
              "width"}]}], "]"}], "-", "1"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "-", 
              RowBox[{"{", 
               RowBox[{"0", ",", "min", ",", "0"}], "}"}]}], "&"}], "/@", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ArrayPad", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "min"}], ",", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "-", 
                  RowBox[{"Length", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], "-", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "3"}], "]"}], "]"}]}]}], 
                "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", "]"}],
       "&"}], "@", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"halt", "=", "False"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TakeWhile", "[", "\[IndentingNewLine]", 
        RowBox[{"#", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
           "halt", ",", "\[IndentingNewLine]", "False", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"1", "-", "width"}], "<=", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "3"}], "]"}], "]"}], "<=", "0"}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{"valid", " ", "position"}], " ", "*)"}], 
            "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "3"}], "]"}], "]"}], "==", "1"}], "||", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "3"}], "]"}], "]"}], "==", 
              RowBox[{"-", "width"}]}]}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{"halt", " ", "position"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"halt", "=", "True"}]}], "\[IndentingNewLine]", "]"}], 
          "&"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "&"}], "@", 
   RowBox[{"TuringMachine", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rule", ",", "n", ",", "k"}], "}"}], ",", 
     RowBox[{"init", "[", "num", "]"}], ",", "maxiters"}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.9602986163629923`*^9, 3.9602986167878933`*^9}, {
   3.9602986686212273`*^9, 3.960298689071632*^9}, {3.960298823945261*^9, 
   3.960298824412078*^9}, {3.96030020274676*^9, 3.960300203554926*^9}, {
   3.9603002530698357`*^9, 3.960300266185831*^9}, {3.960302268585175*^9, 
   3.960302268850256*^9}, {3.960302305920265*^9, 3.96030232321241*^9}, {
   3.9603032720964127`*^9, 3.960303298790053*^9}, {3.960304311832287*^9, 
   3.960304329972269*^9}, {3.960325516016612*^9, 3.960325521767125*^9}, {
   3.960325749361034*^9, 3.960325779806476*^9}, 3.960336814648542*^9, {
   3.960374984990382*^9, 3.9603749898961687`*^9}, {3.960384432872294*^9, 
   3.960384432963406*^9}, {3.960384554532146*^9, 3.9603845554835997`*^9}, {
   3.960384641042634*^9, 3.960384649748353*^9}, {3.96038471973722*^9, 
   3.9603847577918797`*^9}, {3.9603849016651907`*^9, 3.960384920574164*^9}, {
   3.960389802217608*^9, 3.960389831722953*^9}, {3.960451975267004*^9, 
   3.960451975926708*^9}, {3.960452077478486*^9, 3.9604520779087353`*^9}, {
   3.9604522748456497`*^9, 3.960452276881419*^9}, {3.960452745848309*^9, 
   3.960452747541461*^9}, {3.960453299413487*^9, 3.960453364027356*^9}, {
   3.960453401948181*^9, 3.960453467844923*^9}, {3.960454281975161*^9, 
   3.9604542833876333`*^9}, {3.96045460274671*^9, 3.960454614325819*^9}, {
   3.960456569970665*^9, 3.9604565703047743`*^9}, {3.960456693164694*^9, 
   3.960456726376545*^9}, {3.9604568376361027`*^9, 3.960456850902947*^9}, 
   3.960456887021843*^9, {3.9604570740200653`*^9, 3.960457104081958*^9}, {
   3.960471322650505*^9, 3.960471322914607*^9}, {3.960471376114545*^9, 
   3.960471379194356*^9}, {3.9604714411463413`*^9, 3.960471452589419*^9}, {
   3.9604715010837183`*^9, 3.960471501472487*^9}, {3.960473087563439*^9, 
   3.9604730912002497`*^9}, {3.960473163633957*^9, 3.960473164652554*^9}, {
   3.960473272495366*^9, 3.960473315348914*^9}, {3.960473650953026*^9, 
   3.9604736535635138`*^9}, {3.960475278694409*^9, 3.960475285025983*^9}, {
   3.960674750130433*^9, 3.9606747514655113`*^9}, {3.9606789547923307`*^9, 
   3.9606789551101627`*^9}, {3.960679002608453*^9, 3.960679004862217*^9}, {
   3.9606836690366583`*^9, 3.9606836724854507`*^9}, {3.9606837031187077`*^9, 
   3.960683771656364*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"2308a82c-1170-484e-90a4-bbeaa5e1dfd9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hist", "[", 
  RowBox[{"4096", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.96068380379193*^9, 3.960683811878899*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"be47967e-35b1-497f-96cb-77d4f9df0e04"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", 
       RowBox[{"-", "3"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   "}"}]], "Output",
 CellChangeTimes->{3.9606843135785637`*^9, 3.960687327450664*^9, 
  3.9606884663391*^9, 3.960714752400311*^9},
 CellLabel->
  "Out[155]=",ExpressionUUID->"c333889a-17b7-4b19-bc58-db035eeae985"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Riffle", "[", 
   RowBox[{
    RowBox[{"Range", "[", "n", "]"}], ",", 
    RowBox[{"Range", "[", "n", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"%", "[", 
             RowBox[{"[", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "->", 
          RowBox[{"#1", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "&"}], ",", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "4"}], "]"}]}], "]"}], "&"}], 
     ",", "\[IndentingNewLine]", "elems"}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulesCompressed", "=", 
   RowBox[{"%%", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.960679169026043*^9, 3.9606791807644672`*^9}, {
   3.960679211954645*^9, 3.9606792745607157`*^9}, {3.960679327238144*^9, 
   3.960679421660358*^9}, {3.9606794876929483`*^9, 3.96067949315898*^9}, {
   3.960679648460451*^9, 3.960679721030178*^9}, {3.960679859194129*^9, 
   3.960679859989259*^9}, {3.960679926478266*^9, 3.960679993192883*^9}, {
   3.9606811207173643`*^9, 3.960681141644341*^9}, {3.960681202123095*^9, 
   3.9606812531570187`*^9}, {3.960681355700653*^9, 3.960681356605834*^9}, {
   3.9606814906533117`*^9, 3.960681752041353*^9}, {3.9606819161055307`*^9, 
   3.9606819239390097`*^9}, {3.9606820353087673`*^9, 3.960682037309413*^9}, {
   3.960682281406966*^9, 3.960682364870989*^9}, {3.9606845428725224`*^9, 
   3.960684543866227*^9}, 3.960684575149823*^9},
 CellLabel->
  "In[156]:=",ExpressionUUID->"e3344653-014a-4eac-b60a-5bce3568c902"],

Cell[BoxData["29.254002`"], "Output",
 CellChangeTimes->{
  3.960679180990458*^9, {3.960679415035306*^9, 3.9606794219465857`*^9}, {
   3.960679661270961*^9, 3.960679721310648*^9}, {3.9606798395181437`*^9, 
   3.960679860613579*^9}, {3.96067996703071*^9, 3.960679988627075*^9}, 
   3.960680842456176*^9, 3.9606811220568*^9, 3.9606813568639174`*^9, 
   3.9606814986890593`*^9, 3.960681529319413*^9, {3.960681569707117*^9, 
   3.960681661393808*^9}, 3.9606817010957327`*^9, 3.960681889144114*^9, 
   3.960682130166239*^9, 3.960682160574226*^9, {3.960682305603615*^9, 
   3.96068232833279*^9}, {3.960682359722301*^9, 3.960682391161255*^9}, 
   3.960682937113447*^9, 3.960684803880746*^9, 3.9606848423448677`*^9, 
   3.960687354094643*^9, 3.960688497925797*^9, 3.960715089282803*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"4f55d4d0-4de7-4e7c-9c55-cd78544848df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tmRuleToNum", "[", "#", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "rulesCompressed"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ruleNumsCompressed", "=", 
   RowBox[{"%", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.960683605005172*^9, 3.960683629875216*^9}, {
  3.960685742775448*^9, 3.960685775179776*^9}, {3.9606859165078278`*^9, 
  3.960685929809972*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"ce18a8b2-fb76-4853-99f5-ac2be9bedc53"],

Cell[BoxData["1954317"], "Output",
 CellChangeTimes->{3.960685913581572*^9, 3.9606861004378366`*^9, 
  3.960687524828272*^9, 3.960688668675667*^9, 3.960715274556881*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"bbf7736a-f124-4a99-a829-16386c04890b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"hist", "[", 
    RowBox[{
     RowBox[{"ruleNumsCompressed", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}], ",", 
   RowBox[{"Alignment", "->", "Left"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9602986163629923`*^9, 3.9602986167878933`*^9}, {
   3.9602986686212273`*^9, 3.960298689071632*^9}, {3.960298823945261*^9, 
   3.960298824412078*^9}, {3.96030020274676*^9, 3.960300203554926*^9}, {
   3.9603002530698357`*^9, 3.960300266185831*^9}, {3.960302268585175*^9, 
   3.960302268850256*^9}, {3.960302305920265*^9, 3.96030232321241*^9}, {
   3.9603032720964127`*^9, 3.960303298790053*^9}, {3.960304311832287*^9, 
   3.960304329972269*^9}, {3.960325516016612*^9, 3.960325521767125*^9}, {
   3.960325749361034*^9, 3.960325779806476*^9}, 3.960336814648542*^9, {
   3.960374984990382*^9, 3.9603749898961687`*^9}, {3.960384432872294*^9, 
   3.960384432963406*^9}, {3.960384554532146*^9, 3.9603845554835997`*^9}, {
   3.960384641042634*^9, 3.960384649748353*^9}, {3.96038471973722*^9, 
   3.9603847577918797`*^9}, {3.9603849016651907`*^9, 3.960384920574164*^9}, {
   3.960384979696816*^9, 3.960384981035613*^9}, {3.960386246778789*^9, 
   3.960386246982904*^9}, {3.960389675574161*^9, 3.960389748017827*^9}, {
   3.96038978870825*^9, 3.960389788882476*^9}, {3.9603898380393763`*^9, 
   3.960389839920409*^9}, 3.9604527046980247`*^9, {3.960453373053941*^9, 
   3.960453373680139*^9}, {3.960473095143594*^9, 3.960473096437273*^9}, {
   3.9604735284630613`*^9, 3.9604735343882732`*^9}, {3.96047367065432*^9, 
   3.9604736716359377`*^9}, {3.96047405457463*^9, 3.9604740651138477`*^9}, {
   3.9604758423882236`*^9, 3.960475842698024*^9}, {3.960679015090176*^9, 
   3.960679017479084*^9}, {3.960681942086502*^9, 3.960681944626803*^9}, {
   3.960683857052178*^9, 3.960683866769361*^9}, {3.9606857213272657`*^9, 
   3.9606857244977083`*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"276688a2-2bfa-4379-a6de-7ac742c46e01"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "0"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"2", ",", "6", ",", "1"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.9603897890507393`*^9, 3.960389840371914*^9}, 
   3.960451497633821*^9, 3.9604519820684433`*^9, {3.960452279394706*^9, 
   3.960452283266856*^9}, {3.9604527231594133`*^9, 3.960452749989621*^9}, {
   3.960453374087325*^9, 3.960453390001122*^9}, {3.960453469627441*^9, 
   3.960453473046974*^9}, 3.9604537125671587`*^9, 3.960453923075045*^9, {
   3.9604543044006367`*^9, 3.96045432484652*^9}, {3.960454618033908*^9, 
   3.960454621417939*^9}, {3.960456697232286*^9, 3.96045672312729*^9}, 
   3.960456855831211*^9, 3.9604571060764637`*^9, 3.960457367561551*^9, 
   3.9604714564256563`*^9, 3.960471504432782*^9, 3.960471554835747*^9, 
   3.960473167305306*^9, {3.96047327636023*^9, 3.9604733187879667`*^9}, 
   3.960473534724399*^9, 3.960473671991029*^9, {3.960474044154396*^9, 
   3.9604740652627974`*^9}, 3.9604741119431953`*^9, 3.960475142643255*^9, {
   3.960475317682218*^9, 3.9604753343581457`*^9}, 3.9604757619451723`*^9, {
   3.960475819734947*^9, 3.9604758458979263`*^9}, {3.960475876654241*^9, 
   3.9604759057463303`*^9}, 3.9604769818537493`*^9, 3.96047714793629*^9, 
   3.9604772438471613`*^9, 3.960478019381034*^9, 3.960673016226503*^9, 
   3.960674348420485*^9, 3.9606790182839003`*^9, 3.9606822864287767`*^9, 
   3.960682410384858*^9, 3.960682937165575*^9, {3.9606857084376802`*^9, 
   3.9606857249888783`*^9}, 3.960685772060399*^9, 3.960686129917301*^9, 
   3.960687524937971*^9, 3.960688668741433*^9, 3.9607152746578074`*^9},
 CellLabel->
  "Out[163]=",ExpressionUUID->"48e5a75e-2450-44c2-a16e-33634e61b2cf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getevols", "[", 
     RowBox[{"bits_Integer", ",", "rules_List"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"#", ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"h", "=", 
                RowBox[{"hist", "[", 
                 RowBox[{"#", ",", "n"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"h", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "3"}], "]"}], "]"}], "!=",
                  "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{"-", "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{"FromDigits", "[", 
                 RowBox[{
                  RowBox[{"h", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", "2"}], 
                 "]"}]}], "\[IndentingNewLine]", "]"}]}], 
             "\[IndentingNewLine]", "]"}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{"end", " ", "With"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"n", ",", "0", ",", 
              RowBox[{
               RowBox[{"2", "^", "bits"}], "-", "1"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"end", " ", "Table", " ", "over", " ", 
            RowBox[{"2", "^", "bits"}]}], "-", "1"}], " ", "*)"}], 
         "\[IndentingNewLine]", "}"}], "]"}], "&"}], ",", 
      RowBox[{"(*", 
       RowBox[{"end", " ", "Join"}], " ", "*)"}], "\[IndentingNewLine]", 
      "rules"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"end", " ", "Table", " ", "over", " ", "r"}], " ", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.960369806524489*^9, 3.96036996899375*^9}, {
   3.96037013193657*^9, 3.960370208160797*^9}, {3.960370335140643*^9, 
   3.9603703491300488`*^9}, {3.960370520178081*^9, 3.960370554140223*^9}, {
   3.960370605147213*^9, 3.960370605815119*^9}, {3.960370636902421*^9, 
   3.960370637201538*^9}, {3.9603706720141373`*^9, 3.960370702139607*^9}, {
   3.9603707327327337`*^9, 3.96037074539641*^9}, {3.960385094538671*^9, 
   3.960385143484413*^9}, {3.960389566047984*^9, 3.960389566721219*^9}, {
   3.9604573197693787`*^9, 3.960457319814426*^9}, {3.960471844322103*^9, 
   3.960471877000595*^9}, {3.960473102886333*^9, 3.960473103797205*^9}, 
   3.960474345443179*^9, 3.960474483472328*^9, {3.960474929761055*^9, 
   3.960474955331744*^9}, {3.960682199055238*^9, 3.960682206891357*^9}, {
   3.960686417916709*^9, 3.9606864204371347`*^9}, {3.96071176776488*^9, 
   3.9607117951212997`*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"7225177a-2f1f-44c8-9145-b7bdbf488577"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"getevols", "[", 
    RowBox[{"bits", ",", "rules"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evols", "=", 
   RowBox[{"%", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "[", 
  RowBox[{"[", "2237", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.960385416624737*^9, 3.960385491565836*^9}, {
   3.960386262733037*^9, 3.960386263950612*^9}, {3.960389658785077*^9, 
   3.9603896605489397`*^9}, {3.9603898594238033`*^9, 3.960389868918301*^9}, 
   3.960452695804294*^9, {3.9604741213206787`*^9, 3.9604741304313507`*^9}, {
   3.960474168216587*^9, 3.9604741693770113`*^9}, 3.960475800748138*^9, 
   3.960672435502676*^9, {3.960682418639522*^9, 3.9606824305251703`*^9}, {
   3.960683138640114*^9, 3.960683168025303*^9}, {3.960711280169466*^9, 
   3.960711303911701*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"8f90e00e-e69b-4d28-b0ba-4312c87d7ec1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000016`", ",", 
   RowBox[{"getevols", "[", "4", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.960672899827063*^9, {3.960711269176103*^9, 3.960711298774967*^9}},
 CellLabel->"Out[63]=",ExpressionUUID->"91d17fd2-c715-4ba2-a02f-68139aa6fdf3"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"2237\\\"}]\\) of \
\\!\\(\\*RowBox[{\\\"getevols\\\", \\\"[\\\", \\\"4\\\", \\\"]\\\"}]\\) does \
not exist.\"", 2, 65, 4, 31813771907406925921, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{{3.960711269146035*^9, 3.960711298797783*^9}},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"830b47fe-ea57-42b1-91d6-c347e3e5d42b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getevols", "[", "4", "]"}], "\[LeftDoubleBracket]", "2237", 
  "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{
  3.960672899827063*^9, {3.960711269176103*^9, 3.960711298819623*^9}},
 CellLabel->"Out[65]=",ExpressionUUID->"fbc4621f-8f8b-42e2-9ea6-cc8342c547c5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqlgroups", "=", "\[IndentingNewLine]", 
   RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
    RowBox[{"First", ",", "\[IndentingNewLine]", 
     RowBox[{"GatherBy", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"rules", ",", "evols"}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"ContainsOnly", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", 
                RowBox[{"2", ";;", 
                 RowBox[{"-", "1"}]}]}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"-", "1"}], "}"}]}], "]"}]}], "&"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", 
           RowBox[{"2", ";;", 
            RowBox[{"-", "1"}]}]}], "]"}], "]"}], "&"}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.960338449428705*^9, 3.960338647500248*^9, {3.960369509747034*^9, 
   3.960369514829503*^9}, {3.960370239706818*^9, 3.9603702401412697`*^9}, {
   3.960456872970677*^9, 3.960456874847164*^9}, {3.960456927000692*^9, 
   3.960456927895829*^9}, 3.960457162822044*^9, {3.960457362935298*^9, 
   3.960457363020071*^9}, 3.960672355804159*^9, 
   3.960682222029825*^9},ExpressionUUID->"1e97ce38-4560-42ed-b000-\
8699d7dc8069"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "eqlgroups", "]"}]], "Input",
 CellChangeTimes->{{3.960672571279625*^9, 3.960672573592396*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"ce19bd54-1c55-47a2-87ab-63c17a27ff3a"],

Cell[BoxData["351"], "Output",
 CellChangeTimes->{3.960672574353756*^9, 3.960672900081884*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"ffb5ece4-103e-40c6-986f-a7d78774e172"]
}, Open  ]],

Cell["\<\
make a hash set of all states that don\[CloseCurlyQuote]t terminate
make a cache of most recently seen states (or a hash set of all states seen \
in the current simulation) and match them with the current state. if it \
matches then it never halts.
mark the ones that reached the max simulation limit and run them again??\
\>", "Text",
 CellChangeTimes->{{3.960715919700535*^9, 3.960716012191427*^9}, {
  3.9607160582528563`*^9, 
  3.9607161011272182`*^9}},ExpressionUUID->"7892979b-cfe2-4649-aeac-\
48842fb5449e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dp", "=", 
   RowBox[{"CreateDataStructure", "[", "\"\<HashSet\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.960683461384755*^9, 3.960683479325965*^9}, {
   3.9606844628839273`*^9, 3.9606844638121157`*^9}, {3.960685602477211*^9, 
   3.9606856057563257`*^9}, {3.9606858946584263`*^9, 3.960685898245084*^9}, 
   3.960713716141294*^9},ExpressionUUID->"48a7c082-3c1a-4001-a91d-\
202989130dde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"htDP", "[", 
   RowBox[{"rule_Integer", ",", "bits_Integer"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"i", "=", 
         RowBox[{"CreateDataStructure", "[", 
          RowBox[{"\"\<Counter\>\"", ",", "0"}], "]"}]}], ",", 
        RowBox[{"max", "=", 
         RowBox[{"50", "+", 
          RowBox[{"2", "^", 
           RowBox[{"(", 
            RowBox[{"Log2", "[", 
             RowBox[{"n", "+", "1"}], "]"}], ")"}]}]}]}], ",", "tmp", ",", 
        "flag"}], "}"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"50", " ", "+", " ", 
        RowBox[{"2", "n"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NestWhile", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"i", "[", "\"\<Increment\>\"", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"tmp", "=", 
             RowBox[{"TuringMachine", "[", 
              RowBox[{"rule", ",", "#"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"flag", "=", 
             RowBox[{"dp", "[", 
              RowBox[{"\"\<Insert\>\"", ",", 
               RowBox[{"Flatten", "[", "tmp", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "tmp"}], "\[IndentingNewLine]", ")"}], 
          "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "width", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"IntegerDigits", "[", 
              RowBox[{"n", ",", "2", ",", "width"}], "]"}], ",", "0"}], 
            "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"1", "-", "width"}], "<=", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}], "<=", "0"}], "||", 
           RowBox[{"!", "flag"}]}], "&"}], ",", "\[IndentingNewLine]", "1", ",",
          "max"}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "[", "\"\<Get\>\"", "]"}], "==", "max"}], ",", "0", ",", 
         RowBox[{"i", "[", "\"\<Get\>\"", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "^", "bits"}], "-", "1"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.960304762388514*^9, 3.9603047739119864`*^9}, {
   3.960304878009001*^9, 3.960304914863386*^9}, {3.960304950140575*^9, 
   3.9603049722063103`*^9}, {3.960305204790585*^9, 3.960305241296281*^9}, {
   3.9603055879092693`*^9, 3.960305626337557*^9}, {3.960325835959906*^9, 
   3.9603258658482656`*^9}, 3.960328433429381*^9, {3.960338918402323*^9, 
   3.9603389474983387`*^9}, {3.960370963590994*^9, 3.960370964172637*^9}, {
   3.9603712703382874`*^9, 3.96037127562901*^9}, {3.960371638193737*^9, 
   3.96037164230793*^9}, {3.960371808337832*^9, 3.9603718724120207`*^9}, {
   3.960371911716632*^9, 3.960371913792342*^9}, {3.960372020564898*^9, 
   3.9603720224240026`*^9}, {3.960372078987877*^9, 3.960372082214531*^9}, {
   3.9603722040470333`*^9, 3.960372204546536*^9}, {3.9603729572506123`*^9, 
   3.9603729721764727`*^9}, {3.960373007731778*^9, 3.960373027770974*^9}, {
   3.960373062264843*^9, 3.960373103985415*^9}, {3.960373306344039*^9, 
   3.9603734460843773`*^9}, {3.96037355186399*^9, 3.960373560457142*^9}, {
   3.960373595450227*^9, 3.960373601317634*^9}, {3.960373668542849*^9, 
   3.960373679129814*^9}, {3.960373736949746*^9, 3.9603738124748583`*^9}, {
   3.960373857675268*^9, 3.9603739008253593`*^9}, {3.960373936055732*^9, 
   3.960373942733336*^9}, {3.960374006174865*^9, 3.9603740113548098`*^9}, {
   3.9603740500719233`*^9, 3.9603740591014547`*^9}, {3.9603868567700367`*^9, 
   3.9603868584313726`*^9}, {3.960387165542782*^9, 3.960387179856267*^9}, {
   3.960387365481781*^9, 3.960387365579834*^9}, {3.960387416026496*^9, 
   3.960387416223127*^9}, {3.960389596833243*^9, 3.960389597554738*^9}, {
   3.960451281097698*^9, 3.960451284110022*^9}, {3.96045148208239*^9, 
   3.9604514846229067`*^9}, {3.960451555700418*^9, 3.96045155935537*^9}, 
   3.960451666568261*^9, {3.960452323113682*^9, 3.960452385149699*^9}, {
   3.960452846762602*^9, 3.960452847323811*^9}, {3.9604529553049173`*^9, 
   3.960452955414089*^9}, {3.960452997961959*^9, 3.960453042399667*^9}, {
   3.9604531528613453`*^9, 3.960453175141158*^9}, {3.960453527182431*^9, 
   3.960453602274517*^9}, {3.960453689157833*^9, 3.960453689535063*^9}, {
   3.960453749577013*^9, 3.960453750947999*^9}, {3.960454025522574*^9, 
   3.960454026226638*^9}, {3.96047196788883*^9, 3.9604719793883038`*^9}, {
   3.960475300543591*^9, 3.9604753033300037`*^9}, {3.960475597629311*^9, 
   3.9604755990951157`*^9}, {3.960683028910884*^9, 3.9606830564948807`*^9}, 
   3.960683315915835*^9, {3.960683561289692*^9, 3.960683571425761*^9}, {
   3.9606841136904087`*^9, 3.960684138649435*^9}, {3.960684176726584*^9, 
   3.960684228878285*^9}, {3.9606844742774076`*^9, 3.9606844798073072`*^9}, {
   3.960684511043964*^9, 3.96068452670477*^9}, {3.9606847005518227`*^9, 
   3.9606847225276814`*^9}, {3.960685321746277*^9, 3.960685341023493*^9}, {
   3.960685391631754*^9, 3.960685392527185*^9}, {3.9606854705431547`*^9, 
   3.960685478028219*^9}, {3.960685564524428*^9, 3.960685570426803*^9}, {
   3.960685608272428*^9, 3.960685639281473*^9}, {3.960685701591181*^9, 
   3.960685701663158*^9}, {3.960685844976468*^9, 3.960685846910141*^9}, {
   3.960685884738995*^9, 3.960685886951406*^9}, {3.9606866103653917`*^9, 
   3.9606866104438343`*^9}, {3.960686677407967*^9, 3.960686683464682*^9}, {
   3.9607137857874193`*^9, 3.960713787049859*^9}, {3.96071392029723*^9, 
   3.960713931265026*^9}},ExpressionUUID->"8e08526f-a21f-4643-b0a7-\
615c942ee1a0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"htDP", "[", 
  RowBox[{"2237", ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.960389669189254*^9, 3.960389669823451*^9}, {
  3.960389910464262*^9, 3.960389927273127*^9}, {3.960452841175542*^9, 
  3.960452841786262*^9}, {3.960453177507833*^9, 3.9604531781960363`*^9}, {
  3.960453563994837*^9, 3.960453564845171*^9}, {3.9606866124457607`*^9, 
  3.960686612556574*^9}},ExpressionUUID->"4c52b585-8551-4410-a199-\
1c8fc225df6c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3", ",", "5", ",", "3", ",", "7", ",", "3", ",", "5", ",", "3", ",", "9", ",",
    "3", ",", "5", ",", "3", ",", "7", ",", "3", ",", "5", ",", "3"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.960453053000361*^9, {3.960453123172758*^9, 3.960453178522874*^9}, {
   3.960453549867518*^9, 3.960453577470715*^9}, 3.960453607961751*^9, 
   3.96045369328756*^9, {3.960453743021497*^9, 3.9604537537314987`*^9}, 
   3.960453938621641*^9, 3.960454030219605*^9, 3.960454340088234*^9, 
   3.960454637376522*^9, 3.9604573846605597`*^9, 3.960471474321472*^9, 
   3.960471521001483*^9, 3.9604715716665297`*^9, 3.960471985377833*^9, {
   3.960475528791382*^9, 3.960475531489428*^9}, 3.9604757626017437`*^9, {
   3.960475877212349*^9, 3.960475906298893*^9}, 3.960476982497477*^9, 
   3.960477150350593*^9, 3.960477262069846*^9, 3.960478035971096*^9, 
   3.960672154917924*^9, 3.9606725847618027`*^9, 3.9606729003267736`*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"18c7775d-e042-4f61-90c7-396c7945997e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"resAccumulateApply", "=", 
   RowBox[{"ResourceFunction", "[", "\"\<AccumulateApply\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9603287392438517`*^9, 3.960328759918096*^9}, 
   3.9603295047374687`*^9, {3.960330251942338*^9, 3.960330252259993*^9}, {
   3.960387645741087*^9, 3.960387660619522*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"f1790596-5c26-487b-b449-9bddbe9f7b3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"halttimes", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#", ",", 
        RowBox[{"ht", "[", 
         RowBox[{"#", ",", "bits"}], "]"}]}], "}"}], "&"}], ",", "eqlgroups", 
     ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.960305244755351*^9, 3.960305288518352*^9}, {
   3.9603054625924387`*^9, 3.9603054629615393`*^9}, {3.9603054942041683`*^9, 
   3.960305497632476*^9}, {3.960306102235305*^9, 3.960306151630279*^9}, 
   3.9603067519574547`*^9, {3.960306819244957*^9, 3.9603068392740726`*^9}, 
   3.960306934456003*^9, {3.96032584261996*^9, 3.960325863580863*^9}, {
   3.960327426593666*^9, 3.960327426960477*^9}, {3.960328423829464*^9, 
   3.9603284396542587`*^9}, {3.960329508736354*^9, 3.960329553869413*^9}, {
   3.960337105986054*^9, 3.960337109880795*^9}, {3.960338929382893*^9, 
   3.96033894468824*^9}, {3.960361249770049*^9, 3.960361260372435*^9}, {
   3.960363910903411*^9, 3.96036393031674*^9}, {3.960371102697229*^9, 
   3.960371105655909*^9}, {3.960371310163327*^9, 3.960371318123981*^9}, {
   3.960371594386305*^9, 3.9603715965694847`*^9}, 3.9603734737785053`*^9, {
   3.960374068339979*^9, 3.960374075426951*^9}, 3.960389996492175*^9, {
   3.960450890817482*^9, 3.96045089144394*^9}, {3.960475562676312*^9, 
   3.960475570591579*^9}, 3.960475607569206*^9},
 CellLabel->
  "In[133]:=",ExpressionUUID->"4ec612d1-3a2b-493e-a3be-f6d6e1b2427e"]
}, Open  ]]
},
WindowSize->{1504, 896},
WindowMargins->{{Automatic, 0}, {8, Automatic}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2e6dae7c-5ff3-4ab8-9d0a-e70071158f80"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 381, 8, 49, "Input",ExpressionUUID->"a12242b9-b1c9-44e3-92ef-7fdbb93922f3"],
Cell[CellGroupData[{
Cell[960, 32, 155, 3, 53, "Subsection",ExpressionUUID->"3593b4a1-2d33-4767-80e2-aec691c27d16"],
Cell[1118, 37, 1117, 28, 151, "Input",ExpressionUUID->"f75f5dce-d067-4e39-8fe4-0f4e60b4b147"],
Cell[2238, 67, 1742, 44, 274, "Input",ExpressionUUID->"1c601070-3979-4bb6-9da3-0f6328fe6a0e"],
Cell[3983, 113, 1026, 23, 131, "Input",ExpressionUUID->"83d509c4-d56a-49d7-99b5-7ce10f9123fd"],
Cell[CellGroupData[{
Cell[5034, 140, 6938, 146, 519, "Input",ExpressionUUID->"e396a1c9-4716-4c65-a829-35c158031a47"],
Cell[11975, 288, 2823, 86, 94, "Output",ExpressionUUID->"e778a170-0895-41cb-94eb-53fe65fddc9d"],
Cell[14801, 376, 629, 12, 33, "Output",ExpressionUUID->"89f18968-5431-4b07-a5fd-77ca50a3e1d6"]
}, Open  ]],
Cell[15445, 391, 3003, 79, 315, "Input",ExpressionUUID->"a7c356a0-3a27-4303-ae7c-e5c247dff36a"],
Cell[18451, 472, 2045, 56, 192, "Input",ExpressionUUID->"25c6cc06-24ea-4c0f-8692-d285be96ec72"],
Cell[20499, 530, 931, 19, 49, "Input",ExpressionUUID->"d9fcde08-c5f0-45ff-98e4-14451b64a07d"],
Cell[CellGroupData[{
Cell[21455, 553, 1828, 38, 111, "Input",ExpressionUUID->"c06abed9-9d89-4054-b872-089491604238"],
Cell[23286, 593, 1146, 17, 33, "Output",ExpressionUUID->"937721a6-4358-438b-b576-42a2cd4027c4"],
Cell[24435, 612, 1148, 17, 33, "Output",ExpressionUUID->"222afdea-f54d-43a2-bc73-c8688fe32842"],
Cell[25586, 631, 1146, 17, 33, "Output",ExpressionUUID->"cb53e691-580b-4199-b7c0-c372b6e6bb25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26769, 653, 1224, 20, 49, "Input",ExpressionUUID->"1aa6a9f2-5210-4a0a-8269-da7b0cb5d19c"],
Cell[27996, 675, 610, 12, 33, "Output",ExpressionUUID->"d02ceb01-968e-42c8-b621-a905d12a56b1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28643, 692, 330, 7, 49, "Input",ExpressionUUID->"391e68e6-5cf6-4257-9e00-818c5c206254"],
Cell[28976, 701, 424, 7, 33, "Output",ExpressionUUID->"d60aef83-fe50-47d2-9283-1d59a4ab2ccb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29449, 714, 160, 3, 53, "Subsection",ExpressionUUID->"694e79da-f825-4c0f-b70d-16bc848cd5d7"],
Cell[29612, 719, 492, 11, 70, "Input",ExpressionUUID->"2acc88a5-295f-410a-8b8e-9ad37916cbca"],
Cell[30107, 732, 1338, 26, 29, "Input",ExpressionUUID->"882c7138-8d67-4ad7-95eb-86a9bf877760"],
Cell[31448, 760, 192, 3, 36, "CodeText",ExpressionUUID->"19fd9b08-f4d2-4839-b9ec-a1711abc1196"],
Cell[31643, 765, 6367, 137, 478, "Input",ExpressionUUID->"2308a82c-1170-484e-90a4-bbeaa5e1dfd9"],
Cell[CellGroupData[{
Cell[38035, 906, 231, 5, 29, "Input",ExpressionUUID->"be47967e-35b1-497f-96cb-77d4f9df0e04"],
Cell[38269, 913, 1367, 41, 33, "Output",ExpressionUUID->"c333889a-17b7-4b19-bc58-db035eeae985"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39673, 959, 2233, 51, 192, "Input",ExpressionUUID->"e3344653-014a-4eac-b60a-5bce3568c902"],
Cell[41909, 1012, 861, 13, 33, "Output",ExpressionUUID->"4f55d4d0-4de7-4e7c-9c55-cd78544848df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42807, 1030, 715, 19, 70, "Input",ExpressionUUID->"ce18a8b2-fb76-4853-99f5-ac2be9bedc53"],
Cell[43525, 1051, 252, 4, 33, "Output",ExpressionUUID->"bbf7736a-f124-4a99-a829-16386c04890b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43814, 1060, 1985, 32, 29, "Input",ExpressionUUID->"276688a2-2bfa-4379-a6de-7ac742c46e01"],
Cell[45802, 1094, 2069, 38, 46, "Output",ExpressionUUID->"48e5a75e-2450-44c2-a16e-33634e61b2cf"]
}, Open  ]],
Cell[47886, 1135, 3286, 71, 376, "Input",ExpressionUUID->"7225177a-2f1f-44c8-9145-b7bdbf488577"],
Cell[CellGroupData[{
Cell[51197, 1210, 981, 19, 70, "Input",ExpressionUUID->"8f90e00e-e69b-4d28-b0ba-4312c87d7ec1"],
Cell[52181, 1231, 287, 6, 33, "Output",ExpressionUUID->"91d17fd2-c715-4ba2-a02f-68139aa6fdf3"],
Cell[52471, 1239, 460, 11, 26, "Message",ExpressionUUID->"830b47fe-ea57-42b1-91d6-c347e3e5d42b"],
Cell[52934, 1252, 305, 6, 33, "Output",ExpressionUUID->"fbc4621f-8f8b-42e2-9ea6-cc8342c547c5"]
}, Open  ]],
Cell[53254, 1261, 1705, 41, 254, "Input",ExpressionUUID->"1e97ce38-4560-42ed-b000-8699d7dc8069"],
Cell[CellGroupData[{
Cell[54984, 1306, 216, 4, 29, "Input",ExpressionUUID->"ce19bd54-1c55-47a2-87ab-63c17a27ff3a"],
Cell[55203, 1312, 177, 3, 33, "Output",ExpressionUUID->"ffb5ece4-103e-40c6-986f-a7d78774e172"]
}, Open  ]],
Cell[55395, 1318, 524, 10, 77, "Text",ExpressionUUID->"7892979b-cfe2-4649-aeac-48842fb5449e"],
Cell[55922, 1330, 435, 9, 29, "Input",ExpressionUUID->"48a7c082-3c1a-4001-a91d-202989130dde"],
Cell[56360, 1341, 6145, 116, 376, "Input",ExpressionUUID->"8e08526f-a21f-4643-b0a7-615c942ee1a0"],
Cell[CellGroupData[{
Cell[62530, 1461, 452, 8, 29, "Input",ExpressionUUID->"4c52b585-8551-4410-a199-1c8fc225df6c"],
Cell[62985, 1471, 1036, 18, 33, "Output",ExpressionUUID->"18c7775d-e042-4f61-90c7-396c7945997e"]
}, Open  ]],
Cell[64036, 1492, 428, 9, 29, "Input",ExpressionUUID->"f1790596-5c26-487b-b449-9bddbe9f7b3c"],
Cell[64467, 1503, 1480, 28, 29, "Input",ExpressionUUID->"4ec612d1-3a2b-493e-a3be-f6d6e1b2427e"]
}, Open  ]]
}
]
*)

